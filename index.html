
<html lang="zxx" class="js">

    <head>
      <base href="">
      <meta charset="utf-8">
      <meta HTTP-EQUIV="Refresh" content="90000">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <meta name="description" content="@@page-discription">
        
    
      
        <!-- Page Title  -->
        <title>OperationalSecMap</title>
        <!-- StyleSheets  -->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css" rel="stylesheet">
        
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
        <link rel="stylesheet" type="text/css" href="apexcharts.css">
    
        <!-- leaflets  -->
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin=""/>
        <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
        <script src="https://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
       
        
      
        <!-- leafletscluster markers and icons -->
        <link rel="stylesheet" href="MarkerCluster.css" />
        <link rel="stylesheet" href="MarkerCluster.Default.css" />
        <script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/"></script>
        <script src="leaflet.markercluster-src.js"></script>
        <link rel="stylesheet" href="dist/L.Icon.Pulse.css" />
        <script src="dist/L.Icon.Pulse.js"></script>
       
    
      <style>
    
    @import url('https://fonts.googleapis.com/css?family=Oswald|Poppins');
            body {
                /* font-family: 'Oswald', sans-serif; */
                font-family: 'Poppins', sans-serif;
            }
    
            .card-box {
              
                position: relative;
                width: 270px;
                display: -ms-flexbox;
                display: flex;
                -ms-flex-direction: column;
                flex-direction: column;
                -webkit-box-pack: justify;
                -ms-flex-pack: justify;
             
                position: relative;
                cursor: pointer;
              
            }
    
            
            .card-box:after {
                display: block;
                background: #2196F3;
              
                content: '';
                width: 100%;
                position: absolute;
                left: 0;
                right: 0;
                top: 0;
            }
    
            .card-title h2 {
                margin: 0;
                padding-top: 2%;
                color: #05365c;
                font-family: 'Oswald', sans-serif;
              
                font-size: 20px;
                line-height: 1;
                margin-bottom: 10px;
            }
    
            .card-title p {
                margin: 0;
                margin-bottom: 2px;
                font-size: 15px;
                font-weight: 460;
                color:'#070707';
            }
    
            .card-link a {
                text-decoration: none;
                font-family: 'Oswald', sans-serif;
                color: #FF5722;
                font-size: 17px;
                float: right;
            }
    
    
        html, body {
            width: 100%;
            height: 100%;
            margin: 0;
          }
    
        #map {
              width: 100%;
              height: 100%;
            } 
    
        .custom .leaflet-popup-tip,
        .custom .leaflet-popup-content-wrapper {
         background-color: #ffffff;
              opacity: 0.75;
            }
    
        .marker-cluster-small {
              background-color: rgba(218, 94, 94, 0.6);
              }
              .marker-cluster-small div {
              background-color: rgba(226, 36, 36, 0.6);
              }
              .marker-cluster-medium {
              background-color: #d6dadb;
              }
              .marker-cluster-medium div {
              background-color: #35a1af;
              }
    
    
          .box{
              position: absolute;
              top: 0;
              z-index: 9999;
              text-align: left;
              
              margin-left: 6%; /* half of the width */
              margin-top: 1%;
              background-color:white;
              Opacity: 0.97;
              height: 13%;
             
          }
    
    
    
    
    
      </style>
    
    </head>
    
    <body>
     
        <div class="container-fluid" style="background-color: whitesmoke;">
       
            <div class="row">
        
              <div class="col-sm-3" style="height: 100%;">
        
                <h3 style="font-size: 20px; margin-left: 6%; margin-bottom: 26px;">Operational Cybersecurity Health</h3>
              
                  <div id="vis1" style="width:100%; height: 220px; background-color: white; margin-bottom: 20px;"></div>
          
                  <div id="vis2" style="width:100%; height: 340px; background-color: white; margin-bottom: 20px;"></div>
               
                  <div id="zz" style="width:100%; height: 420px; background-color: white; margin-bottom: 20px;"></div>
        
              </div>
        
              
                <div class="col-sm-9">
                <div class= "map" id="map" style="width: 100%; height: 100%;"></div>
                </div>
        
        
             
        
        
        
            </div>
          </div>
         
        
        
    
    <!------------------- JavaScript ------------------------>
    
    <script type="text/javascript">
    
          var th;
          var td;
          var tm;
          var dl;
          var da; 
    
          async function loadNames() {
           
            var response = await fetch('http://localhost:8088/api/clients/wks-96445-mac.ad.tuni.fi/30601/');
            var lresponse  = await fetch('http://localhost:8088/api/clients/wks-96445-mac.ad.tuni.fi/6/');
            var sresponse = await fetch('http://localhost:8088/api/clients/wks-96445-mac.ad.tuni.fi/30602/');
            var sech = await response.json();
            var loc = await lresponse.json();
            var iss = await sresponse.json();
           
            th = JSON.stringify(sech.content.instances[0].resources[0].value);
        tm = JSON.stringify(sech.content.instances[0].resources[1].value);
              
            dl = JSON.stringify(loc.content.instances[0].resources[0].value);
            da = JSON.stringify(loc.content.instances[0].resources[1].value);
              
    
            //alert(td+th); 
            
            var test =  [22.17041015625,
                            60.42097096224303];
            var n1= "SensorTest01";
            var tt=tm;
            var et= th;
                       
            var jsontest = {"type": "FeatureCollection",
                   "features": [
          
                   {
                  "type": "Feature",
                  "geometry": {
                      "type": "Point",
                      "coordinates":  [22.17981015625,
                            60.42987096224303]
                  },
                  "properties": {
                  "Name": n1,
                  "year":"1890",
                  "time":tt,
                  "eventType":"30",
                  "notes":""
                  }
                  },
          
                  {
                  "type": "Feature",
                  "properties": {"Name":"SensorDeviceB12",
                  "year":"1890",
                  "time":tt,
          
                  "eventType":th,
                  "notes":""},
                  "geometry": {
                  "type": "Point",
                  "coordinates": [da,dl]
                  }
                  },
                  {
                  "type": "Feature",
                  "properties": {"Name":"SensorDeviceC01",
                  "year":"1890",
                  "time":tt,
          
                  "eventType":"25",
                  "notes":""},
                  "geometry": {
                  "type": "Point",
                  "coordinates": [
                    22.176246643066406,
                    60.424317866142296
                  ]
                  }
                  },
                  {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":tt,
        "days":"",
        "organiser":"desc of events",
        "eventType":"15",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.217960357666016,
              60.436918622243546
        ]
        }
        },
        {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":tt,
        "days":"",
        "organiser":"desc of events",
        "eventType":"15",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.21306800842285,
            60.43420828369019
        ]
        }
        },
        {
            "type": "Feature",
            "properties": { "Name":"SensorDevice17",
            "year":"1890",
            "time":tt,
            "days":"",
            "organiser":"desc of events",
            "eventType":"15",
            "notes":"desc of events"},
            "geometry": {
            "type": "Point",
            "coordinates": [
                22.21010684967041,
          60.43168831307181
            ]
            }
            },
            {
                "type": "Feature",
                "properties": { "Name":"SensorDevice17",
                "year":"1890",
                "time":tt,
                "days":"",
                "organiser":"desc of events",
                "eventType":"10",
                "notes":"desc of events"},
                "geometry": {
                "type": "Point",
                "coordinates": [
                    22.211995124816895,
          60.43183655204558
                ]
                }
                },
                {
                    "type": "Feature",
                    "properties": { "Name":"SensorDevice17",
                    "year":"1890",
                    "time":tt,
                    "days":"",
                    "organiser":"desc of events",
                    "eventType":"15",
                    "notes":"desc of events"},
                    "geometry": {
                    "type": "Point",
                    "coordinates": [
                        22.20487117767334,
          60.435605830231445
                    ]
                    }
                    },
                    {
                        "type": "Feature",
                        "properties": { "Name":"SensorDevice17",
                        "year":"1890",
                        "time":tt,
                        "days":"",
                        "organiser":"desc of events",
                        "eventType":"15",
                        "notes":"desc of events"},
                        "geometry": {
                        "type": "Point",
                        "coordinates": [
                            22.198691368103027,
                            60.43422945908613
                        ]
                        }
                        },
                        {
                            "type": "Feature",
                            "properties": { "Name":"SensorDevice17",
                            "year":"1890",
                            "time":tt,
                            "days":"",
                            "organiser":"desc of events",
                            "eventType":"15",
                            "notes":"desc of events"},
                            "geometry": {
                            "type": "Point",
                            "coordinates": [
                                22.199549674987793,
                                60.42952818275973
                            ]
                            }
                            },
                            {
                                "type": "Feature",
                                "properties": { "Name":"SensorDevice17",
                                "year":"1890",
                                "time":tt,
                                "days":"",
                                "organiser":"desc of events",
                                "eventType":"15",
                                "notes":"desc of events"},
                                "geometry": {
                                "type": "Point",
                                "coordinates": [
                                    22.193198204040527,
                                    60.43052355475511
                                ]
                                }
                                },
                                              
              {
              "type": "Feature",
              "properties": { "Name":"CameraSensorA",
              "year":"1890",
              "time":tt,
      
              "eventType":"15",
              "notes":""},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.190065383911133,
                60.42567347602639
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"CameraSensorATest",
              "year":"1890",
              "time":tt,
      
              "eventType":"25",
              "notes":""},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.192039489746094,
                60.42541930347811
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"CameraSensorB",
              "year":"1890",
              "time":tt,
      
              "eventType":"15",
              "notes":""},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.165346145629883,
                60.41906434399841
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"CameraSensorATest",
              "year":"1890",
              "time":tt,
              "days":"",
              "organiser":"",
              "eventType":"15",
              "notes":""},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.18560218811035,
                60.423089295866475
              ]
              }
              },
    
              {
    "type": "Feature",
    "properties": { "Name":"SensorDevice06",
    "year":"1890",
    "time":tt,
    "days":"",
    "organiser":"",
    "eventType":"30",
    "notes":""},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.207317352294922,
          60.43338243248793
    ]
    }
    },
    
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":tt,
    "days":"",
    "organiser":"",
    "eventType":"15",
    "notes":""},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.20508575439453,
        60.43744795885954
    ]
    }
    },
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":tt,
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":""},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.16543197631836,
        60.42181831225118
    ]
    }
    },
    
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":tt,
    "days":"",
    "organiser":"desc of events",
    "eventType":"15",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.156505584716797,
        60.41542027374547
    ]
    }
    },
    {
        "type": "Feature",
        "properties": { "Name":"SensorDevice06",
        "year":"1890",
        "time":tt,
        "days":"",
        "organiser":"desc of events",
        "eventType":"15",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.155561447143555,
          60.4224961763612
        ]
        }
        },
    
        {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":tt,
        "days":"",
        "organiser":"desc of events",
        "eventType":"15",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.158308029174805,
          60.41931856622256
        ]
        }
        },
        {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":tt,
        "days":"",
        "organiser":"desc of events",
        "eventType":"15",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.1498966217041,
            60.4105891326906
        ]
        }
        },
    
        {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":tt,
        "days":"",
        "organiser":"desc of events",
        "eventType":"15",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.15195655822754,
            60.414996518149216
        ]
        }
        },
    
              {
              "type": "Feature",
              "properties": { "Name":"CameraSensorATest",
              "year":"1890",
              "time":tt,
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.187576293945312,
                60.423131661131464
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"CameraSensorA03",
              "year":"1890",
              "time":tt,
              "days":"",
              "organiser":"desc of events",
              "eventType":"15",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.18817710876465,
                60.428469242924386
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"CameraSensorB02",
              "year":"1890",
              "time":tt,
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.190494537353516,
                60.42901989594342
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"CameraSensorATest",
              "year":"1893",
              "time":tt,
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.19212532043457,
                60.429951749036036
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"RadarSensorA07",
              "year":"1890",
              "time":tt,
              "days":"",
              "organiser":"desc of events",
              "eventType":"15",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.17641830444336,
                60.41728473278787
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"RadarSensorA11",
              "year":"1890",
              "time":tt,
              "days":"",
              "organiser":"desc of events",
              "eventType":"15",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.194185256958008,
                60.42330112163948
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"RadarSensorTest",
              "year":"1890",
              "time":tt,
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.197790145874023,
                60.425758199767614
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"TRadarSensorTest",
              "year":"1890",
              "time":tt,
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.20233917236328,
                60.434907064472334
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"RadarSensorTest",
              "year":"1890",
              "time":tt,
              "days":"",
              "organiser":"desc of events",
              "eventType":"15",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.20499992370605,
                60.43452591318082
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"RadarSensorTest",
              "year":"1890",
              "time":tt,
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.20834732055664,
                60.43621988470891
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"RadarSensorTest",
              "year":"1893",
              "time":tt,
              "days":"",
              "organiser":"desc of events",
              "eventType":"15",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.2198486328125,
                60.43554230669233
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"RadarSensorTest",
              "year":"1893",
              "time":tt,
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.22053527832031,
                60.43372124577595
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"RadarSensorTest",
              "year":"1890",
              "time":tt,
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.223453521728516,
                60.43685510127025
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"SensorDevice07",
              "year":"1890",
              "time":tt,
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.214269638061523,
                60.431264769421716
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"SensorDevice09",
              "year":"1890",
              "time":tt,
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.208261489868164,
                60.43075650975716
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"SensorDevice06",
              "year":"1890",
              "time":tt,
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.185430526733395,
                60.42694430896449
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"SensorDevice17",
              "year":"1890",
              "time":tt,
              "days":"",
              "organiser":"desc of events",
              "eventType":"15",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.195730209350586,
                60.431857728986664
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"SensorDevice17",
              "year":"1890",
              "time":tt,
              "days":"",
              "organiser":"desc of events",
              "eventType":"25",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
              22.173757553100582,
          60.421309904895715
              ]
              }
              },
              {
    "type": "Feature",
    "properties": { "Name":"SensorDevice06",
    "year":"1890",
    "time":tt,
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.160797119140625,
        60.41563214947344
    ]
    }
    },
    
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":tt,
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.162857055664062,
        60.42351294603258
    ]
    }
    },
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":tt,
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.199764251708984,
        60.433255376594396
    ]
    }
    },
    
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":tt,
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.151355743408203,
        60.419954113089155
    ]
    }
    },
    
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice06",
    "year":"1890",
    "time":tt,
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.179336547851562,
        60.42550402788162
    ]
    }
    },
    
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":tt,
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.1828556060791,
          60.42647834265461
    ]
    }
    },
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":tt,
    "days":"",
    "organiser":"desc of events",
    "eventType":"15",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.192039489746094,
        60.42749498781193
    ]
    }
    },
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice06",
    "year":"1890",
    "time":tt,
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.203712463378906,
          60.43278950073571
    ]
    }
    },
    
    
    
    
    
    
    
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":tt,
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.194700241088867,
        60.42770678488512
    ]
    }
    },
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":tt,
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.182340621948242,
        60.42440259341581
    ]
    }
    },
    
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":tt,
    "days":"",
    "organiser":"desc of events",
    "eventType":"0",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.177019119262695,
          60.42228434534471
    ]
    }
    },
    {
        "type": "Feature",
        "properties": { "Name":"SensorDevice06",
        "year":"1890",
        "time":tt,
        "days":"",
        "organiser":"desc of events",
        "eventType":"10",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.16620445251465,
          60.42347058126437
        ]
        }
        },
    
        {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":tt,
        "days":"",
        "organiser":"desc of events",
        "eventType":"10",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.178049087524414,
            60.418725377941705
        ]
        }
        },
        {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":tt,
        "days":"",
        "organiser":"desc of events",
        "eventType":"0",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.16586112976074,
            60.41762371385904
        ]
        }
        },
        {
    "type": "Feature",
    "properties": { "Name":"SensorDevice06",
    "year":"1890",
    "time":tt,
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.21487045288086,
        60.439734593969625
    ]
    }
    },
    
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":tt,
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.211952209472656,
          60.43761734475579
    ]
    }
    },
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":tt,
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.219762802124023,
        60.441894046063425
    ]
    }
    },
    
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":tt,
    "days":"",
    "organiser":"desc of events",
    "eventType":"0",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.218732833862305,
          60.43791376794984
    ]
    }
    },
    {
        "type": "Feature",
        "properties": { "Name":"SensorDevice06",
        "year":"1890",
        "time":tt,
        "days":"",
        "organiser":"desc of events",
        "eventType":"10",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.212553024291992,
            60.436473972823286
        ]
        }
        },
    
        {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":tt,
        "days":"",
        "organiser":"desc of events",
        "eventType":"10",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.214698791503903,
          60.43537290998097
        ]
        }
        },
        {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":tt,
        "days":"",
        "organiser":"desc of events",
        "eventType":"0",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.215900421142578,
            60.43338243248793
        ]
        }
        },
    
        {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":tt,
        "days":"",
        "organiser":"desc of events",
        "eventType":"10",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.216758728027344,
          60.441258927991655
        ]
        }
        },
    
        {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":tt,
        "days":"",
        "organiser":"desc of events",
        "eventType":"0",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.21014976501465,
            60.434017704505926
        ]
        }
        },
    
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":tt,
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.200794219970703,
          60.42973996658771
    ]
    }
    },
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":tt,
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
    22.21748828887939,
          60.434547088369825
    ]
    }
    },
    {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":tt,
        "days":"",
        "organiser":"desc of events",
        "eventType":"10",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.21886157989502,
            60.434187108280454
        ]
        }
        },
        {
            "type": "Feature",
            "properties": { "Name":"SensorDevice17",
            "year":"1890",
            "time":tt,
            "days":"",
            "organiser":"desc of events",
            "eventType":"10",
            "notes":"desc of events"},
            "geometry": {
            "type": "Point",
            "coordinates": [
                22.218518257141113,
                60.434949414339926
            ]
            }
            },
            {
                "type": "Feature",
                "properties": { "Name":"SensorDevice17",
                "year":"1890",
                "time":tt,
                "days":"",
                "organiser":"desc of events",
                "eventType":"10",
                "notes":"desc of events"},
                "geometry": {
                "type": "Point",
                "coordinates": [
                    22.222251892089844,
                    60.433191848461384
                ]
                }
                },
                {
                    "type": "Feature",
                    "properties": { "Name":"SensorDevice17",
                    "year":"1890",
                    "time":tt,
                    "days":"",
                    "organiser":"desc of events",
                    "eventType":"10",
                    "notes":"desc of events"},
                    "geometry": {
                    "type": "Point",
                    "coordinates": [
                        22.218518257141113,
                        60.434949414339926
                    ]
                    }
                    },
                    {
                        "type": "Feature",
                        "properties": { "Name":"SensorDevice17",
                        "year":"1890",
                        "time":tt,
                        "days":"",
                        "organiser":"desc of events",
                        "eventType":"10",
                        "notes":"desc of events"},
                        "geometry": {
                        "type": "Point",
                        "coordinates": [
                            22.222251892089844,
                            60.433191848461384
                        ]
                        }
                        },
                        {
                            "type": "Feature",
                            "properties": { "Name":"SensorDevice17",
                            "year":"1890",
                            "time":tt,
                            "days":"",
                            "organiser":"desc of events",
                            "eventType":"10",
                            "notes":"desc of events"},
                            "geometry": {
                            "type": "Point",
                            "coordinates": [
                                22.21886157989502,
                                60.436029317319516
                            ]
                            }
                            },
                            {
                                "type": "Feature",
                                "properties": { "Name":"SensorDevice17",
                                "year":"1890",
                                "time":tt,
                                "days":"",
                                "organiser":"desc of events",
                                "eventType":"10",
                                "notes":"desc of events"},
                                "geometry": {
                                "type": "Point",
                                "coordinates": [
                                    22.21911907196045,
                                    60.43962873478501
                                ]
                                }
                                },
                                              
                                {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":tt,
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.211651802062985,
        60.43632575499799
    ]
    }
    },
    {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":tt,
        "days":"",
        "organiser":"desc of events",
        "eventType":"10",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.219505310058594,
            60.436770406446065
        ]
        }
        },
        {
            "type": "Feature",
            "properties": { "Name":"SensorDevice17",
            "year":"1890",
            "time":tt,
            "days":"",
            "organiser":"desc of events",
            "eventType":"10",
            "notes":"desc of events"},
            "geometry": {
            "type": "Point",
            "coordinates": [
                22.212638854980465,
          60.438273706764974
            ]
            }
            },
            {
                "type": "Feature",
                "properties": { "Name":"SensorDevice17",
                "year":"1890",
                "time":tt,
                "days":"",
                "organiser":"desc of events",
                "eventType":"15",
                "notes":"desc of events"},
                "geometry": {
                "type": "Point",
                "coordinates": [
                    22.213754653930664,
                    60.439776937546895
                ]
                }
                },
                {
                    "type": "Feature",
                    "properties": { "Name":"SensorDevice17",
                    "year":"1890",
                    "time":tt,
                    "days":"",
                    "organiser":"desc of events",
                    "eventType":"10",
                    "notes":"desc of events"},
                    "geometry": {
                    "type": "Point",
                    "coordinates": [
                        22.2137975692749,
                        60.437786729769165
                    ]
                    }
                    },
                    {
                        "type": "Feature",
                        "properties": { "Name":"SensorDevice17",
                        "year":"1890",
                        "time":tt,
                        "days":"",
                        "organiser":"desc of events",
                        "eventType":"10",
                        "notes":"desc of events"},
                        "geometry": {
                        "type": "Point",
                        "coordinates": [
                            22.215213775634766,
                            60.436664537605466
                        ]
                        }
                        },
                        {
                            "type": "Feature",
                            "properties": { "Name":"SensorDevice17",
                            "year":"1890",
                            "time":tt,
                            "days":"",
                            "organiser":"desc of events",
                            "eventType":"10",
                            "notes":"desc of events"},
                            "geometry": {
                            "type": "Point",
                            "coordinates": [
                                22.20963478088379,
                                60.43552113215167
                            ]
                            }
                            },
                            {
                                "type": "Feature",
                                "properties": { "Name":"SensorDevice17",
                                "year":"1890",
                                "time":tt,
                                "days":"",
                                "organiser":"desc of events",
                                "eventType":"10",
                                "notes":"desc of events"},
                                "geometry": {
                                "type": "Point",
                                "coordinates": [
                                    22.213926315307617,
          60.43907826146615
                                ]
                                }
                                },
                                              
      
              {
              "type": "Feature",
              "geometry": {
                  "type": "Point",
                  "coordinates":  [22.19701766967773,
                        60.42889282299763]
              },
              "properties": {
              "Name":"SensorDevice08",
              "year":"1893",
              "time":tt,
              "days":"21",
              "eventType":"15",
              "notes":"desc of events"
              }
              }
              ]};
    
               
          
    
            var addressPoints = [
                [60.4313, 22.2143, "2"],
                [60.4301, 22.2119, "3"],
                [60.4403, 22.2205, "6"],
                [60.4379, 22.2187, "4"],
                [60.4385, 22.2219, "10"]
    
            ]
    
    
            var map = new L.map("map", {
          
                            center: [60.4336, 22.1930],//22.2177, 60.438  60.4216, 22.1982
                            zoom: 14.49
                        //center: [60.4349, 22.1892],
                        //zoom: 14.19
                          });
    
            //map.invalidateSize(true);
            
    
            var mbAttr = 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, ' +
            'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
            mbUrl = 'https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw';
    L.tileLayer('https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"', {}).addTo(map);
            //L.tileLayer(mbUrl, {id: 'mapbox/light-v9', tileSize: 512, zoomOffset: -1, attribution: mbAttr}).addTo(map)
          
            //var pulsingIcon = L.icon.pulse({iconSize:[18,18],color:'#d5759a'});
            //var ao = L.marker([60.42097096224303, 22.17041015625],{icon: pulsingIcon}).addTo(map); 
          
            //L.geoJSON(jsontest).addTo(map);    
              
           var healthy = {
                                radius: 9,
                                fillColor: "#20a1a6", //08979D
                                weight: 0,
                                opacity: 0,
                                fillOpacity: 0.98
                            };
    
            var dy = {
                                radius: 13,
                                fillColor: "#20a1a6",
                                weight: 0,
                                opacity: 0,
                                fillOpacity: 0.9
                            };             
    
            var ol = {
                                radius: 15,
                                fillColor: "#282622",
                                weight: 0,
                                opacity: 0,
                                fillOpacity: 0.3
                            };
     
            var risks = {
                                radius: 15,
                                fillColor: "#ebc24f", //#FF5100
                                weight: 0,
                                opacity: 0,
                                fillOpacity: 0.8
                            };
          
    
     //Low risk vis;  
              
              
    
          var popbaseRl = '<div class="card-box">\
                        <div class="card-title" >\
                          <h2 style="color: #e6c42c;"><i class="fas fa-exclamation-triangle" style="color: #ebcf55;"></i> SensorTest01</h2>\
                            <p>Security Health: Low Risk</p>\
                            <p>Time</p>\
                            <p>Prvious Issues:</p>\
                            <p style="font-size: 11px;">Anything new?</p>\
                        </div>\
                         <div class="card-link" style="margin-top: 9px;">\
                          <form id="popup-form">\
                           <textarea id="input-speed" class="popup-input" type="text" style="height: 32px; width: 270px;"></textarea>\
                           <div style="margin-bottom: 6px;" id="vi"></div>\
                           <input class="w3-radio" type="radio" name="sh" value="25">\
                           <label>Urgent</label>\
                           <input class="w3-radio" type="radio" name="sh" value="25">\
                           <label>Healthy</label>\
                           <input class="w3-radio" type="radio" name="sh" value="30">\
                           <label>Under Attacked</label><br>\
                           <input class="w3-radio" type="radio" name="sh" value="0">\
                           <label>Offline</label>\
                           </form>\
                            <a class="c-link" id="button-submit" type="button">Send\
                                <i class="fa fa-angle-right"></i>\
                            </a>\
                        </div>\
                    </div>';
    
     var atestk = [
              [60.4286, 22.1990],
              [60.4410, 22.2144],
              [60.4226, 22.2052],
              [60.4256, 22.1687]
              ]
          
    
    
              for (var j = 0; j < atestk.length; j++) {
              var idl = j;
              var cxl= "marker" + idl;
              var picturel = L.marker(atestk[j], {
                          icon: L.divIcon({
                              className: 'leaflet-echart-icon',
                              iconSize: [36, 36],
                              html: '<div id="' + cxl + '"style="width: 45px; height: 60px; position: relative; background-color: transparent;"></div>'
                          })
                      }).addTo(map).bindPopup(popbaseRl);
                      
              var myChart = echarts.init(document.getElementById(cxl));
    
              var colorPalette = ['#C8AEAC']
                    
              option = {
                        
                          tooltip: {
                              trigger: 'item',
                              
                            color: "black",
                            borderWidth: "1", 
                            borderColor: "ffffff", 
                            textStyle: {
                              color: "#666666" 
                            },
                            formatter: '{b0}',
    
                          },
                          
                          series: [
                              {
                                  color: colorPalette,
                                
                                  name: 'Security issues',
                                  type: 'pie',
                                  selectedMode: 'single',
                                  radius: [0, '24%'],
                                  
                                  labelLine: {
                                      show: false
                                  },
                                  data: [
                                    
                                      
                                      {value: "2", name: 'Security issues #description'}
                                  ]
                              },
                              {
                                color: '#EECA66',
                                  name: '',
                                  type: 'pie',
                                  radius: ['26%', '62%'],
                                  labelLine: {
                                      length: 30,
                                  },
                                  label: {
                                    show: false
                                  },
                                  data: [
                                      {value: 600, name: 'Low risky'}
                                    
                                
                                  ]
                              }
                          ]
                      };
    
              myChart.setOption(option);
    
              }
    
    
         
    
    
    
    
            //var pulsingIcon = L.icon.pulse({iconSize:[20,20],color:'red'});
            //var ao = L.marker(latlng,{icon: pulsingIcon}).addTo(map);               
          
            L.geoJSON(jsontest, {
                                pointToLayer: function (feature, latlng) {
                                  if (feature.properties.eventType == "10") {
                                  return L.circleMarker(latlng, healthy);
                              } else if (feature.properties.eventType == "0")
                                {
                                    return L.circleMarker(latlng, ol);
                                }
                               else if (feature.properties.eventType == "15")
                                {
                                    return L.circleMarker(latlng, dy);
                                }
                              else if (feature.properties.eventType == "25")
                                {
                                  return L.marker(latlng,{icon: L.icon.pulse({iconSize:[20,20],color:'#b8778c', fillColor: '#9b7ba8'})}); //#c57b92
                                 
                                } else if (feature.properties.eventType == "30" )
                                  {
                                    var pulsingIcon = L.icon.pulse({iconSize:[25,25],color:'#5A2E2D'});
                                    var ao = L.marker(latlng,{icon: pulsingIcon});
                                    return ao;
    
                                  } else if (feature.properties.eventType == "20")
                                  {
    
                                    return L.circleMarker(latlng, risks);
                                  // console.log(a);
                          
                                  } 
                            },
                            onEachFeature: onEachFeature
                            }).addTo(map);      
          
    
    
                      
            function onEachFeature(feature, layer) {
          
           
            var vary;
            var ic;
            var se;
            var template = '<form id="popup-form">\
                           <textarea id="input-speed" class="popup-input" type="text" style="height: 41px;"></textarea>\
                           <div id="vi"></div>\
                           <input class="w3-radio" type="radio" name="gender" value="male" checked>\
                           <label>Urgent</label>\
                           <input class="w3-radio" type="radio" name="gender" value="female">\
                           <label>Minor</label>\
                           <input class="w3-radio" type="radio" name="gender" value="okay">\
                           <label>Minor</label><br>\
                           <button id="button-submit" type="button" class="btn btn-primary btn-sm" style="margin-top: 6px;">Send</button>\
                           </form>';
    
            var popbase = '<div class="card-box">\
                        <div class="card-title" >\
                            <h2><i class="fas fa-virus" style="color:red;"></i> Malware Detection</h2>\
                            <p>SensorTest01</p>\
                            <p>Security Health: Under Attack!</p>\
                          <p>Time: ' + feature.properties.time + '</p><p>Prvious Issues: None</p>\
                          <p style="font-size: 11px;">Anything new?</p>\
                        </div>\
                            <div class="card-link" style="margin-top: 9px;">\
                          <form id="popup-form">\
                           <textarea id="input-speed" class="popup-input" type="text" style="height: 32px; width: 270px;"></textarea>\
                           <div style="margin-bottom: 6px;" id="vi"></div>\
                           <input class="w3-radio" type="radio" name="sh" value="25">\
                           <label>Resolved</label>\
                           <input class="w3-radio" type="radio" name="sh" value="20">\
                           <label>Urgent</label>\
                           <input class="w3-radio" type="radio" name="sh" value="30">\
                           <label>Low Risk</label>\
                           <input class="w3-radio" type="radio" name="sh" value="0">\
                           <label>Offline</label>\
                           </form>\
                            <a class="c-link" id="button-submit" type="button">Send\
                                <i class="fa fa-angle-right"></i>\
                            </a>\
                        </div>\
                    </div>';
    
               var popbaseN = '<div class="card-box">\
                      <div class="card-title" >\
                        <h2><i class="material-icons" style="color:#3f999d; font-size: 19px;">security</i> SensorTest01</h2>\
                          <p>Security Health: Good</p>\
                          <p>Time: ' + feature.properties.time + '</p><p>Prvious Issues: None</p>\
                          <p style="font-size: 11px;">Anything new?</p>\
                      </div>\
                          <div class="card-link" style="margin-top: 9px;">\
                        <form id="popup-form">\
                         <textarea id="input-speed" class="popup-input" type="text" style="height: 32px; width: 270px;"></textarea>\
                         <div style="margin-bottom: 6px;" id="vi"></div>\
                         <input class="w3-radio" type="radio" name="sh" value="25">\
                         <label>Urgent</label>\
                         <input class="w3-radio" type="radio" name="sh" value="20">\
                         <label>Low risk</label>\
                         <input class="w3-radio" type="radio" name="sh" value="30">\
                         <label>Under Attacked</label><br>\
                         <input class="w3-radio" type="radio" name="sh" value="0">\
                         <label>Offline</label>\
                         </form>\
                          <a class="c-link" id="button-submit" type="button">Send\
                              <i class="fa fa-angle-right"></i>\
                          </a>\
                      </div>\
                  </div>';
  
    
        
       var popbaseR = '<div class="card-box">\
                        <div class="card-title" >\
                          <h2 style="color: #b55875;"><i class="fas fa-exclamation-circle" style="color: #b55875;"></i> SensorTest01</h2>\
                            <p>Security Health: High Risk</p>\
                            <p>Time: ' + feature.properties.time + '</p><p>Prvious Issues: None</p>\
                          <p style="font-size: 11px;">Anything new?</p>\
                      </div>\
                 <div class="card-link" style="margin-top: 9px;">\
                          <form id="popup-form">\
                           <textarea id="input-speed" class="popup-input" type="text" style="height: 32px; width: 270px;"></textarea>\
                           <div style="margin-bottom: 6px;" id="vi"></div>\
                           <input class="w3-radio" type="radio" name="sh" value="25">\
                           <label>Healthy</label>\
                           <input class="w3-radio" type="radio" name="sh" value="20">\
                           <label>Low risk</label>\
                           <input class="w3-radio" type="radio" name="sh" value="30">\
                           <label>Under Attacked</label><br>\
                           <input class="w3-radio" type="radio" name="sh" value="0">\
                           <label>Offline</label>\
                           </form>\
                            <a class="c-link" id="button-submit" type="button">Send\
                                <i class="fa fa-angle-right"></i>\
                            </a>\
                        </div>\
                    </div>';
            
    
        
    
              
                    var popbase0 = '<div class="card-box">\
                        <div class="card-title" >\
                          <h2><i class="material-icons">portable_wifi_off</i> SensorTest07</h2>\
                            <p>Security Health: Offline</p>\
                              <p>Time: ' + feature.properties.time + '</p><p>Prvious Issues: None</p>\
                          <p style="font-size: 11px;">Anything new?</p>\
                        </div>\
                             <div class="card-link" style="margin-top: 9px;">\
                          <form id="popup-form">\
                           <textarea id="input-speed" class="popup-input" type="text" style="height: 32px; width: 270px;"></textarea>\
                           <div style="margin-bottom: 6px;" id="vi"></div>\
                           <input class="w3-radio" type="radio" name="sh" value="25">\
                           <label>Urgent</label>\
                           <input class="w3-radio" type="radio" name="sh" value="25">\
                           <label>Healthy</label>\
                           <input class="w3-radio" type="radio" name="sh" value="20">\
                           <label>Low risk</label><br>\
                           <input class="w3-radio" type="radio" name="sh" value="30">\
                           <label>Under Attacked</label>\
                           </form>\
                            <a class="c-link" id="button-submit" type="button">Send\
                                <i class="fa fa-angle-right"></i>\
                            </a>\
                        </div>\
                    </div>';
            
              var vis = '<div class="card-box">\
                      <div class="card-link" style="margin-top: 9px;">\
                        <div id="radial-chart-primary"></div>\
                        </div>\
                    </div>';
            
    
            var popupContentw = '<div class="card-box"><div class="card-title" >\
                          <h2><i class="fas fa-paper-plane" style="color: #FF5722;"></i> The issues has been sent ！</h2>\
                        </div>\
                    </div>';
    
    
    
                 
    
            var customOptions =
                {
                  'maxWidth': '500',
                  'className' : 'custom'
                }
    
                            
            switch (feature.properties.eventType) {
    
                              case "0":  //healthy ones
                                vary = popbase0;
                                se = "all fine";
                                ic="SEnsorname";
                                break;
                              case "10":  //healthy ones
                                vary = popbaseN;
                                se = "all fine";
                                ic="SEnsorname";
                                break;
                  case "15":  //healthy ones
                                vary = popbaseN;
                                se = "all fine";
                                ic="SEnsorname";
                                break;
                   case "25":  //healthy ones
                                vary = popbaseR;
                                se = "risky";
                                ic="SEnsorname";
                                break;
                              case "20": //risky ones 
                                vary = popbaseR;
                                se = "risky";
                                ic="<i class='material-icons' style='color:pink'>warning</i>Malware Detection!";
                                break;
                              case "30": //under atatck ones
                                vary = popbase;
                                se = "Malware Detetcion";
                                ic="<i class='material-icons' style='color:red'>error</i> Malware Detection!";
                                break;
                            }
                        
            var popupContent = vary;
    
            //pictures.bindPopup(popbaseN);
    
            layer.bindPopup(popupContent,customOptions);
    
            layer.on('click', layerClickHandler);
                            
            function layerClickHandler (e) {
    
                 
    
                  var marker = e.target;
                        properties = e.target.feature.properties;
                                    
                  if (marker.hasOwnProperty('_popup')) {
                                        //circleMarker.unbindPopup();
                  }
    
                  marker.bindPopup(popupContent);
                  marker.openPopup();
    
                  //L.DomUtil.get('vi').textContent = properties.notes;
    
                  var inputSpeed = L.DomUtil.get('input-speed');
                  //inputSpeed.value = properties.notes;
                  inputSpeed.value = " ";
                  L.DomEvent.addListener(inputSpeed, 'change', function (e) {
                    var temp = e.target.value;
                              const http = new EasyHTTP;
                    // User Data
                              var data = {"id":3,"value":temp};
    
                      // Update Post
                      http.put(
                      'http://localhost:8088/api/clients/wks-96445-mac.ad.tuni.fi/30602/0/3',
                    data)
                      .then(data => console.log(data))
                      .catch(err => console.log(err));
                  });
    
                  var buttonSubmit = L.DomUtil.get('button-submit');
                  L.DomEvent.addListener(buttonSubmit, 'click', function (e) {
                  e.preventDefault();
                    var radios = document.getElementsByName('sh');
    
                      for (var i = 0, length = radios.length; i < length; i++) {
                      if (radios[i].checked) {
                      // do whatever you want with the checked radio
                      alert(radios[i].value);
    
    
    
                      //properties.eventType = "20";
                      //e.preventDefault();
                      // only one radio can be logically checked, don't check the rest
                      }
                    
                
    
                      }
                  marker.bindPopup(popupContentw);
    
    
                   var klat = k.lat;
                  var klng = k.lng;
    
              
                  marker.remove();
                  //marker.setIcon();
                  var al = L.circleMarker([klat, klng], risks).addTo(map).update();
    
                  });
    
                  } //click function
    
    
                  var markers = L.markerClusterGroup({
                  singleMarkerMode: true,
                  zoomToBoundsOnClick: true,
                  iconCreateFunction: function (cluster) {
                     
                      var childCount = cluster.getChildCount();
                      var c = ' marker-cluster-';
                      if (childCount < 10) {
                        c += 'medium';
                      } 
                      else if (childCount < 100) {
                        c += 'small';
                      } 
                      else {
                        c += 'large';
                }
    
                return new L.DivIcon({ html: '<div><span>' + childCount + '</span></div>', 
                className: 'marker-cluster' + c, iconSize: new L.Point(40, 40) });
            }
          });
    
              for (var i = 0; i < addressPoints.length; i++) {
                var a = addressPoints[i];
                var title = a[2];
                var marker = L.marker(new L.LatLng(a[0], a[1]), {
                
                  title: title
                });
                marker.bindPopup(popupContent);
                markers.addLayer(marker);
              }
    
              map.addLayer(markers);
    
              
           
    
            
    
    
                            //bindTooltip bindPopup
                            //layer.bindTooltip(feature.properties.time);
             } //eachfeature function
        
       
                
          } //loadNames function
    
          loadNames();
         
    
    </script>
    
     <script type="text/javascript">
    
          class EasyHTTP {
    
          // Make an HTTP PUT Request
          async put(url, data) {
    
            // Awaiting fetch which contains method,
            // headers and content-type and body
              const response = await fetch(url, {
              method: 'PUT',
              headers: {
                'Content-type': 'application/json'
              },
              body: JSON.stringify(data)
              });
              
              // Awaiting response.json()
              const resData = await response.json();
    
              // Return response data
              return resData;
            }
          }
        
    
      </script>	
        
    
    
    <script type="text/javascript">
    
    var chartDom = document.getElementById("vis1");
    var myChartv1 = echarts.init(chartDom);
    var optionv1;
    
    optionv1 = {
      //color:['#312525','#a487b0','#EECA66','#aca79d','#08979D'],
     title:{
          x: '2%', // 水平安放位置，默认为左对齐，可选为：'center' ¦ 'left' ¦ 'right' ¦ {number}（x坐标，单位px）
            y: '5%',
        text: 'Summary',
        textStyle: {
                fontSize: 17, // 主标题文字大小
                fontWeight: 'bolder', // 主标题文字加粗
                color: '#767676' // 主标题文字颜色
            },
        },
     
    
      toolbox: {
        show: true,
        
      },
      series: [
        {
          name: 'Nightingale Chart',
          type: 'pie',
          radius: ['30%', '55%'],
          center: ['50%', '50%'],
          
        itemStyle: {
          borderRadius: 10,
          borderColor: '#fff',
          borderWidth: 2
        },
        emphasis: {
                  focus: 'self',
                  label: {
                  show: true,
                 
               
                 
              }
             }, 
          data: [
          
            { value: 7, name: 'Under Attack 2', itemStyle: {
                        color: '#454545'
                        }},
            { value: 16, name: 'High Risk 16' ,itemStyle: {
                        color: '#a487b0'
                        }},
            { value: 36, name: 'Low Risk 36', itemStyle: {
                        color: '#e6c42c'
                        }},
            { value: 22, name: 'Offline 22' , itemStyle: {
                        color: '#aca79d'
                        }},
            { value: 126, name: 'Healthy 126',   itemStyle: {
                        color: '#4cb3b7'
                        }
                     },
          ]
        }
      ]
     
    };
    
    if (optionv1 && typeof optionv1 === 'object') {
                myChartv1.setOption(optionv1);
            }
    
    
    </script>
    
    <script type="text/javascript">
    
      var chartDom = document.getElementById("vis2");
      var myChartv2 = echarts.init(chartDom);
      var optionv2;
      
      optionv2 = {
        color:['#939aee','#FF92AE'],
        title: {
          x: '3%', // 水平安放位置，默认为左对齐，可选为：'center' ¦ 'left' ¦ 'right' ¦ {number}（x坐标，单位px）
            y: '5%',
        text: 'Security Tendency',
        textStyle: {
                fontSize: 17, // 主标题文字大小
                fontWeight: 'bolder', // 主标题文字加粗
                color: '#767676' // 主标题文字颜色
            },
        },
        tooltip: {
          trigger: 'axis'
        },
        legend: {
          orient: 'vertical',
            x:'62%',      //可设定图例在左、右、居中
            y:'3%',     //可设定图例在上、下、居中
            padding:[0,50,0,0],   //可设定图例[距上方距离，距右方距
    
        },
        grid: {
         top: '25%',
         bottom:'10%'
        
        },
        xAxis: {
          type: 'category',
          boundaryGap: false,
          data: ['May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov']
        },
        yAxis: {
          type: 'value',
          axisLabel: {
            formatter: '{value}'
          },
          splitLine: {
                    lineStyle: {
                        type: 'dashed'
                    }
                },
          min: 0,
          max: 60,
          interval:10,
        },
        series: [
          {
            name: 'Incidents',
             type: 'line',
            symbolSize:1,
            smooth:true,
            data: [20, 31, 43, 21, 52, 32, 39],
            markPoint: {
              data: [
                { type: 'max', name: 'Max' },
               
              ],
                   itemStyle: {
                                    color: '#cccbca'
                                 },
            },
            markLine: {
              data: [{ type: 'average', name: 'Avg' }]
            }
          },
          {
            name: 'Devices at Risks',
            type: 'line',
            symbolSize:1,
            smooth:true,
            data: [16, 27, 21, 35, 43, 32, 19],
           
           
          }
         
        ]
      };
      
      if (optionv2 && typeof optionv2 === 'object') {
                  myChartv2.setOption(optionv2);
              }
      
      
      </script>
    
    
    
    
    <script type="text/javascript">
    var chartDom = document.getElementById('zz');
    var myChartz = echarts.init(chartDom);
    var optionz;
    
    const pathSymbols = {
      I:
        'path://M953.4 844.4 540.2 145.4c-5.8-10-16.6-17.4-28.2-17.4-11.8 0-22.6 7.4-28.2 17.4L70.6 844.4c-5.6 10-9.6 26-3.8 35.8 5.8 9.8 16.4 15.8 28 15.8l834.2 0c11.6 0 22.2-6 28-15.8C963 870.4 959 854.2 953.4 844.4zM576 800l-128 0 0-96 128 0L576 800zM576 640l-128 0L448 352l128 0L576 640z',
      rk:
        'path://path://M953.4 844.4 540.2 145.4c-5.8-10-16.6-17.4-28.2-17.4-11.8 0-22.6 7.4-28.2 17.4L70.6 844.4c-5.6 10-9.6 26-3.8 35.8 5.8 9.8 16.4 15.8 28 15.8l834.2 0c11.6 0 22.2-6 28-15.8C963 870.4 959 854.2 953.4 844.4zM576 800l-128 0 0-96 128 0L576 800zM576 640l-128 0L448 352l128 0L576 640z',
      train:
        'path://M896 469.333333h-7.253333c-44.928 0-83.541333-28.544-100.565334-70.144l-0.896-2.090666c-17.408-41.685333-10.624-89.472 21.333334-121.429334l5.077333-5.077333a42.624 42.624 0 1 0-60.330667-60.330667l-5.077333 5.077334c-31.957333 31.957333-79.744 38.741333-121.429333 21.333333l-2.090667-0.896C583.210667 218.794667 554.666667 179.968 554.666667 135.04v-3.456C554.666667 104.405333 535.594667 85.333333 512 85.333333s-42.666667 19.072-42.666667 42.666667v1.536c0 46.762667-28.16 88.917333-71.381333 106.794667l-0.256 0.128a115.626667 115.626667 0 0 1-125.994667-25.088l-1.066666-1.066667a42.624 42.624 0 1 0-60.330667 60.330667l1.536 1.536a114.773333 114.773333 0 0 1 24.874667 124.970666l-1.152 2.730667A112.554667 112.554667 0 0 1 131.626667 469.333333h-0.042667C104.405333 469.333333 85.333333 488.405333 85.333333 512s19.072 42.666667 42.666667 42.666667h2.901333a113.493333 113.493333 0 0 1 104.917334 70.144l0.896 2.090666a114.773333 114.773333 0 0 1-24.874667 124.970667l-1.536 1.536a42.624 42.624 0 1 0 60.330667 60.330667l1.536-1.536a114.730667 114.730667 0 0 1 124.970666-24.874667l6.101334 2.56A106.88 106.88 0 0 1 469.333333 888.746667v3.626666c0 27.221333 19.072 46.293333 42.666667 46.293334s42.666667-19.114667 42.666667-42.666667v-7.253333c0-43.306667 26.069333-82.346667 66.133333-98.901334l10.752-4.437333a107.008 107.008 0 0 1 116.736 23.253333l5.077333 5.077334a42.624 42.624 0 1 0 60.330667-60.330667l-5.077333-5.077333c-31.957333-31.957333-38.741333-79.744-21.333334-121.429334l0.896-2.090666c17.024-41.6 55.850667-70.144 100.778667-70.144h3.413333c27.221333 0 46.293333-19.072 46.293334-42.666667s-19.072-42.666667-42.666667-42.666667zM341.333333 554.666667a42.666667 42.666667 0 1 1 0-85.333334 42.666667 42.666667 0 0 1 0 85.333334z m213.333334 149.333333a42.666667 42.666667 0 1 1 0-85.333333 42.666667 42.666667 0 0 1 0 85.333333z m42.666666-192a85.333333 85.333333 0 1 1 0.042667-170.709333A85.333333 85.333333 0 0 1 597.333333 512z',
      ship: 'path://M16.678,17.086h9.854l-2.703,5.912c5.596,2.428,11.155,5.575,16.711,8.607c3.387,1.847,6.967,3.75,10.541,5.375 v-6.16l-4.197-2.763v-5.318L33.064,12.197h-11.48L20.43,15.24h-4.533l-1.266,3.286l0.781,0.345L16.678,17.086z M49.6,31.84 l0.047,1.273L27.438,20.998l0.799-1.734L49.6,31.84z M33.031,15.1l12.889,8.82l0.027,0.769L32.551,16.1L33.031,15.1z M22.377,14.045 h9.846l-1.539,3.365l-2.287-1.498h1.371l0.721-1.352h-2.023l-0.553,1.037l-0.541-0.357h-0.34l0.359-0.684h-2.025l-0.361,0.684 h-3.473L22.377,14.045z M23.695,20.678l-0.004,0.004h0.004V20.678z M24.828,18.199h-2.031l-0.719,1.358h2.029L24.828,18.199z  M40.385,34.227c-12.85-7.009-25.729-14.667-38.971-12.527c1.26,8.809,9.08,16.201,8.213,24.328 c-0.553,4.062-3.111,0.828-3.303,7.137c15.799,0,32.379,0,48.166,0l0.066-4.195l1.477-7.23 C50.842,39.812,45.393,36.961,40.385,34.227z M13.99,35.954c-1.213,0-2.195-1.353-2.195-3.035c0-1.665,0.98-3.017,2.195-3.017 c1.219,0,2.195,1.352,2.195,3.017C16.186,34.604,15.213,35.954,13.99,35.954z M23.691,20.682h-2.02l-0.588,1.351h2.023 L23.691,20.682z M19.697,18.199l-0.721,1.358h2.025l0.727-1.358H19.697z',
      car: 'path://path://M953.4 844.4 540.2 145.4c-5.8-10-16.6-17.4-28.2-17.4-11.8 0-22.6 7.4-28.2 17.4L70.6 844.4c-5.6 10-9.6 26-3.8 35.8 5.8 9.8 16.4 15.8 28 15.8l834.2 0c11.6 0 22.2-6 28-15.8C963 870.4 959 854.2 953.4 844.4zM576 800l-128 0 0-96 128 0L576 800zM576 640l-128 0L448 352l128 0L576 640z'
    };
    const labelSetting = {
      show: true,
      position: 'right',
      offset: [10, 0],
      fontSize: 13
    };
    optionz = {
     
      title: {
        x: '3%', // 水平安放位置，默认为左对齐，可选为：'center' ¦ 'left' ¦ 'right' ¦ {number}（x坐标，单位px）
            y: '5%',
        text: 'Top Vulnerable Assets',
        textStyle: {
                fontSize: 17, // 主标题文字大小
                fontWeight: 'bolder', // 主标题文字加粗
                color: '#767676' // 主标题文字颜色
            },
      },
      legend: {
        orient: 'vertical',
            x:'76%',      //可设定图例在左、右、居中
            y:'3%',     //可设定图例在上、下、居中
            padding:[0,50,0,0],   //可设定图例[距上方距离，距右方距
    
        data: ['Incidents', 'Risks']
      },
      tooltip: {
        trigger: 'axis',
        axisPointer: {
          type: 'shadow'
        }
      },
      grid: {
        containLabel: true,
        left: 9,
        bottom:10,
      },
      yAxis: {
        data: ['DeviceX', 'SensorsA0', 'DeviceY', 'SensorB', 'AssetD'],
        inverse: true,
        axisLine: { show: false },
        axisTick: { show: false },
        axisLabel: {
          margin: 20,
          fontSize: 12
        },
        axisPointer: {
          label: {
            show: true,
            margin: 30
          }
        }
      },
      xAxis: {
        splitLine: { show: false },
        axisLabel: { show: false },
        axisTick: { show: false },
        axisLine: { show: false }
      },
      series: [
        {
          name: 'Incidents',
          type: 'pictorialBar',
          label: labelSetting,
          symbolRepeat: true,
          symbolSize: ['90%', '80%'],
          barCategoryGap: '40%',
          itemStyle: {
                        color: '#a487b0'
                        },
                    
          data: [
            {
              value: 39,
              symbol: pathSymbols.train
            },
            {
              value: 27,
              symbol: pathSymbols.train
            },
            {
              value: 18,
              symbol: pathSymbols.train
            },
            {
              value: 12,
              symbol: pathSymbols.train
            },
            {
              value: 9,
              symbol: pathSymbols.train
            }
          ]
        },
        {
          name: 'Risks',
          type: 'pictorialBar',
          barGap: '7%',
          label: labelSetting,
          symbolRepeat: true,
          symbolSize: ['90%', '80%'],
          itemStyle: {
                        color: '#e6c42c'
                        },
                    
          data: [
            {
              value: 76,
              symbol: pathSymbols.rk
            },
            {
              value: 64,
              symbol: pathSymbols.rk
            },
            {
              value: 56,
              symbol: pathSymbols.rk
            },
            {
              value: 31,
              symbol: pathSymbols.rk
            },
            {
              value: 25,
              symbol: pathSymbols.rk
            }
          ]
        }
      ]
    };
    
    optionz && myChartz.setOption(optionz);
    
    </script>
    
    
    
    
    
    </body>
    </html>
    
    
    
