<html lang="zxx" class="js">

<head>
  <base href="">
  <meta charset="utf-8">
  <meta name="author" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="@@page-discription">

  
    <!-- Page Title  -->
    <title>OperationalSecMap</title>
    <!-- StyleSheets  -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css" rel="stylesheet">
    
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
    <link rel="stylesheet" type="text/css" href="apexcharts.css">

    <!-- leaflets  -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
    <script src="https://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
   
    
  
    <!-- leafletscluster markers and icons -->
    <link rel="stylesheet" href="MarkerCluster.css" />
    <link rel="stylesheet" href="MarkerCluster.Default.css" />
    <script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/"></script>
    <script src="leaflet.markercluster-src.js"></script>
    <link rel="stylesheet" href="dist/L.Icon.Pulse.css" />
    <script src="dist/L.Icon.Pulse.js"></script>
   

  <style>

@import url('https://fonts.googleapis.com/css?family=Oswald|Poppins');
        body {
            /* font-family: 'Oswald', sans-serif; */
            font-family: 'Poppins', sans-serif;
        }

        .card-box {
          
            position: relative;
            width: 280px;
            display: -ms-flexbox;
            display: flex;
            -ms-flex-direction: column;
            flex-direction: column;
            -webkit-box-pack: justify;
            -ms-flex-pack: justify;
         
            position: relative;
            cursor: pointer;
          
        }

        
        .card-box:after {
            display: block;
            background: #2196F3;
          
            content: '';
            width: 100%;
            position: absolute;
            left: 0;
            right: 0;
            top: 0;
        }

        .card-title h2 {
            margin: 0;
            padding-top: 2%;
            color: #05365c;
            font-family: 'Oswald', sans-serif;
          
            font-size: 20px;
            line-height: 1;
            margin-bottom: 10px;
        }

        .card-title p {
            margin: 0;
            margin-bottom: 2px;
            font-size: 15px;
            font-weight: 460;
            color:'#070707';
        }

        .card-link a {
            text-decoration: none;
            font-family: 'Oswald', sans-serif;
            color: #FF5722;
            font-size: 17px;
            float: right;
        }


    html, body {
        width: 100%;
        height: 100%;
        margin: 0;
      }

    #map {
          width: 100%;
          height: 100%;
        } 

    .custom .leaflet-popup-tip,
    .custom .leaflet-popup-content-wrapper {
     background-color: #ffffff;
          opacity: 0.65;
        }

    .marker-cluster-small {
          background-color: rgba(218, 94, 94, 0.6);
          }
          .marker-cluster-small div {
          background-color: rgba(226, 36, 36, 0.6);
          }
          .marker-cluster-medium {
          background-color: #d6dadb;
          }
          .marker-cluster-medium div {
          background-color: #35a1af;
          }


      .box{
          position: absolute;
          top: 0;
          z-index: 9999;
          text-align: left;
          
          margin-left: 6%; /* half of the width */
          margin-top: 1%;
          background-color:white;
          Opacity: 0.97;
          height: 13%;
         
      }




.nk-cov-data .amount { font-size: 2rem; line-height: 1.1; font-weight: 700; color: #364a63; }

.overline-title { float: left; margin-left: 4%; font-size: 11px; line-height: 1.2; letter-spacing: 0.2em; color: #707172; font-weight: 700; font-family: Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif; }
  </style>

</head>

<body>
 
  <div class="box col-lg-3" style="padding-bottom: px;">

    <h5 style="font-size: 20px; margin-top: 18px;">Operational Cybersecurity Posture</h5>

    <div class="row">
     
        <h6 class="overline-title" style="font-size: 12px; margin-top: 7px;">Total Assets: 226</h6>
              <div class="btn-group btn-group-toggle" data-toggle="buttons" title="" style="margin-top: 10px;margin-left: 5%; width: 100%; ">
             
                <label class="btn" style="height: 3px; width: 50%; background-color: #08979D;">
                  <input type="radio" name="button" id="option1" autocomplete="off" title="Healthy devices : 189"> 
                </label>
                <label class="btn" style="height: 3px; width: 15%; background-color: #EECA66;">
                  <input type="radio" name="options" id="option2" autocomplete="off" title="Low risky devices : 19"> 
                </label>

                <label class="btn" style="height: 3px; width: 10%; background-color: #A57891;">
                  <input type="radio" name="options" id="option2" autocomplete="off" title="High risky devices : 9"> 
                </label>
              
                <label class="btn" style="height: 3px; width: 5%; background-color: #626363;">
                  <input type="radio" name="options" id="option3" autocomplete="off" title="Under Attack : 2"> 
                </label>
                <label class="btn" style="height: 3px; width: 2%; background-color: #A29E93;">
                  <input type="radio" name="options" id="option2" autocomplete="off" title="Offline : 3"> 
                </label>

              </div>
          
      </div>  
  </div>

<div class="" id="map"></div>

<!------------------- JavaScript ------------------------>

<script type="text/javascript">

      var th;
      var td;
      var tm;
      var dl;
      var da; 

      async function loadNames() {
       
        var response = await fetch('http://localhost:8088/api/clients/wks-96445-mac.ad.tuni.fi/30601/');
        var lresponse  = await fetch('http://localhost:8088/api/clients/wks-96445-mac.ad.tuni.fi/6/');
        var sresponse = await fetch('http://localhost:8088/api/clients/wks-96445-mac.ad.tuni.fi/30602/');
        var sech = await response.json();
        var loc = await lresponse.json();
        var iss = await sresponse.json();
       
        th = JSON.stringify(sech.content.instances[0].resources[0].value);
	tm = JSON.stringify(sech.content.instances[0].resources[1].value);
	      
        dl = JSON.stringify(loc.content.instances[0].resources[0].value);
        da = JSON.stringify(loc.content.instances[0].resources[1].value);
	      

        //alert(td+th); 
        
        var test =  [22.17041015625,
                        60.42097096224303];
        var n1= "SensorTest01";
        var tt=tm;
        var et= th;
                   
        var jsontest = {"type": "FeatureCollection",
               "features": [
      
               {
              "type": "Feature",
              "geometry": {
                  "type": "Point",
                  "coordinates":  [22.17981015625,
                        60.42987096224303]
              },
              "properties": {
              "Name": n1,
              "year":"1890",
              "time":tt,
              "eventType":"30",
              "notes":""
              }
              },
      
              {
              "type": "Feature",
              "properties": {"Name":"SensorDeviceB12",
              "year":"1890",
              "time":tt,
      
              "eventType":th,
              "notes":""},
              "geometry": {
              "type": "Point",
              "coordinates": [da,dl]
              }
              },
              {
              "type": "Feature",
              "properties": {"Name":"SensorDeviceC01",
              "year":"1890",
              "time":tt,
      
              "eventType":"20",
              "notes":""},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.176246643066406,
                60.424317866142296
              ]
              }
              },
              {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":"September",
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.217960357666016,
          60.436918622243546
    ]
    }
    },
    {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":"September",
        "days":"",
        "organiser":"desc of events",
        "eventType":"10",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.21306800842285,
            60.43420828369019
        ]
        }
        },
        {
            "type": "Feature",
            "properties": { "Name":"SensorDevice17",
            "year":"1890",
            "time":"September",
            "days":"",
            "organiser":"desc of events",
            "eventType":"10",
            "notes":"desc of events"},
            "geometry": {
            "type": "Point",
            "coordinates": [
                22.21010684967041,
          60.43168831307181
            ]
            }
            },
            {
                "type": "Feature",
                "properties": { "Name":"SensorDevice17",
                "year":"1890",
                "time":"September",
                "days":"",
                "organiser":"desc of events",
                "eventType":"10",
                "notes":"desc of events"},
                "geometry": {
                "type": "Point",
                "coordinates": [
                    22.211995124816895,
          60.43183655204558
                ]
                }
                },
                {
                    "type": "Feature",
                    "properties": { "Name":"SensorDevice17",
                    "year":"1890",
                    "time":"September",
                    "days":"",
                    "organiser":"desc of events",
                    "eventType":"10",
                    "notes":"desc of events"},
                    "geometry": {
                    "type": "Point",
                    "coordinates": [
                        22.20487117767334,
          60.435605830231445
                    ]
                    }
                    },
                    {
                        "type": "Feature",
                        "properties": { "Name":"SensorDevice17",
                        "year":"1890",
                        "time":"September",
                        "days":"",
                        "organiser":"desc of events",
                        "eventType":"10",
                        "notes":"desc of events"},
                        "geometry": {
                        "type": "Point",
                        "coordinates": [
                            22.198691368103027,
                            60.43422945908613
                        ]
                        }
                        },
                        {
                            "type": "Feature",
                            "properties": { "Name":"SensorDevice17",
                            "year":"1890",
                            "time":"September",
                            "days":"",
                            "organiser":"desc of events",
                            "eventType":"10",
                            "notes":"desc of events"},
                            "geometry": {
                            "type": "Point",
                            "coordinates": [
                                22.199549674987793,
                                60.42952818275973
                            ]
                            }
                            },
                            {
                                "type": "Feature",
                                "properties": { "Name":"SensorDevice17",
                                "year":"1890",
                                "time":"September",
                                "days":"",
                                "organiser":"desc of events",
                                "eventType":"10",
                                "notes":"desc of events"},
                                "geometry": {
                                "type": "Point",
                                "coordinates": [
                                    22.193198204040527,
                                    60.43052355475511
                                ]
                                }
                                },
                                              
              {
              "type": "Feature",
              "properties": { "Name":"CameraSensorA",
              "year":"1890",
              "time":"September",
      
              "eventType":"25",
              "notes":""},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.190065383911133,
                60.42567347602639
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"CameraSensorATest",
              "year":"1890",
              "time":"September",
      
              "eventType":"20",
              "notes":""},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.192039489746094,
                60.42541930347811
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"CameraSensorB",
              "year":"1890",
              "time":"September",
      
              "eventType":"10",
              "notes":""},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.165346145629883,
                60.41906434399841
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"CameraSensorATest",
              "year":"1890",
              "time":"September",
              "days":"",
              "organiser":"",
              "eventType":"10",
              "notes":""},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.18560218811035,
                60.423089295866475
              ]
              }
              },

              {
    "type": "Feature",
    "properties": { "Name":"SensorDevice06",
    "year":"1890",
    "time":"September",
    "days":"",
    "organiser":"",
    "eventType":"30",
    "notes":""},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.207317352294922,
          60.43338243248793
    ]
    }
    },

    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":"September",
    "days":"",
    "organiser":"",
    "eventType":"10",
    "notes":""},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.20508575439453,
        60.43744795885954
    ]
    }
    },
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":"September",
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":""},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.16543197631836,
        60.42181831225118
    ]
    }
    },

    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":"September",
    "days":"",
    "organiser":"desc of events",
    "eventType":"20",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.156505584716797,
        60.41542027374547
    ]
    }
    },
    {
        "type": "Feature",
        "properties": { "Name":"SensorDevice06",
        "year":"1890",
        "time":"September",
        "days":"",
        "organiser":"desc of events",
        "eventType":"10",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.155561447143555,
          60.4224961763612
        ]
        }
        },
    
        {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":"September",
        "days":"",
        "organiser":"desc of events",
        "eventType":"20",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.158308029174805,
          60.41931856622256
        ]
        }
        },
        {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":"September",
        "days":"",
        "organiser":"desc of events",
        "eventType":"20",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.1498966217041,
            60.4105891326906
        ]
        }
        },
    
        {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":"September",
        "days":"",
        "organiser":"desc of events",
        "eventType":"10",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.15195655822754,
            60.414996518149216
        ]
        }
        },
    
              {
              "type": "Feature",
              "properties": { "Name":"CameraSensorATest",
              "year":"1890",
              "time":"September",
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.187576293945312,
                60.423131661131464
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"CameraSensorA03",
              "year":"1890",
              "time":"September",
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.18817710876465,
                60.428469242924386
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"CameraSensorB02",
              "year":"1890",
              "time":"September",
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.190494537353516,
                60.42901989594342
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"CameraSensorATest",
              "year":"1893",
              "time":"September",
              "days":"",
              "organiser":"desc of events",
              "eventType":"20",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.19212532043457,
                60.429951749036036
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"RadarSensorA07",
              "year":"1890",
              "time":"September",
              "days":"",
              "organiser":"desc of events",
              "eventType":"20",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.17641830444336,
                60.41728473278787
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"RadarSensorA11",
              "year":"1890",
              "time":"September",
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.194185256958008,
                60.42330112163948
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"RadarSensorTest",
              "year":"1890",
              "time":"September",
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.197790145874023,
                60.425758199767614
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"TRadarSensorTest",
              "year":"1890",
              "time":"September",
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.20233917236328,
                60.434907064472334
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"RadarSensorTest",
              "year":"1890",
              "time":"September",
              "days":"",
              "organiser":"desc of events",
              "eventType":"20",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.20499992370605,
                60.43452591318082
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"RadarSensorTest",
              "year":"1890",
              "time":"September",
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.20834732055664,
                60.43621988470891
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"RadarSensorTest",
              "year":"1893",
              "time":"September",
              "days":"",
              "organiser":"desc of events",
              "eventType":"20",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.2198486328125,
                60.43554230669233
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"RadarSensorTest",
              "year":"1893",
              "time":"September",
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.22053527832031,
                60.43372124577595
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"RadarSensorTest",
              "year":"1890",
              "time":"September",
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.223453521728516,
                60.43685510127025
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"SensorDevice07",
              "year":"1890",
              "time":"September",
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.214269638061523,
                60.431264769421716
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"SensorDevice09",
              "year":"1890",
              "time":"September",
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.208261489868164,
                60.43075650975716
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"SensorDevice06",
              "year":"1890",
              "time":"September",
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.185430526733395,
                60.42694430896449
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"SensorDevice17",
              "year":"1890",
              "time":"September",
              "days":"",
              "organiser":"desc of events",
              "eventType":"10",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
                22.195730209350586,
                60.431857728986664
              ]
              }
              },
              {
              "type": "Feature",
              "properties": { "Name":"SensorDevice17",
              "year":"1890",
              "time":"September",
              "days":"",
              "organiser":"desc of events",
              "eventType":"20",
              "notes":"desc of events"},
              "geometry": {
              "type": "Point",
              "coordinates": [
              22.173757553100582,
          60.421309904895715
              ]
              }
              },
              {
    "type": "Feature",
    "properties": { "Name":"SensorDevice06",
    "year":"1890",
    "time":"September",
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.160797119140625,
        60.41563214947344
    ]
    }
    },

    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":"September",
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.162857055664062,
        60.42351294603258
    ]
    }
    },
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":"September",
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.199764251708984,
        60.433255376594396
    ]
    }
    },

    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":"September",
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.151355743408203,
        60.419954113089155
    ]
    }
    },

    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice06",
    "year":"1890",
    "time":"September",
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.179336547851562,
        60.42550402788162
    ]
    }
    },

    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":"September",
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.1828556060791,
          60.42647834265461
    ]
    }
    },
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":"September",
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.192039489746094,
        60.42749498781193
    ]
    }
    },
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice06",
    "year":"1890",
    "time":"September",
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.203712463378906,
          60.43278950073571
    ]
    }
    },







    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":"September",
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.194700241088867,
        60.42770678488512
    ]
    }
    },
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":"September",
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.182340621948242,
        60.42440259341581
    ]
    }
    },

    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":"September",
    "days":"",
    "organiser":"desc of events",
    "eventType":"0",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.177019119262695,
          60.42228434534471
    ]
    }
    },
    {
        "type": "Feature",
        "properties": { "Name":"SensorDevice06",
        "year":"1890",
        "time":"September",
        "days":"",
        "organiser":"desc of events",
        "eventType":"10",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.16620445251465,
          60.42347058126437
        ]
        }
        },
    
        {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":"September",
        "days":"",
        "organiser":"desc of events",
        "eventType":"10",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.178049087524414,
            60.418725377941705
        ]
        }
        },
        {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":"September",
        "days":"",
        "organiser":"desc of events",
        "eventType":"0",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.16586112976074,
            60.41762371385904
        ]
        }
        },
        {
    "type": "Feature",
    "properties": { "Name":"SensorDevice06",
    "year":"1890",
    "time":"September",
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.21487045288086,
        60.439734593969625
    ]
    }
    },

    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":"September",
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.211952209472656,
          60.43761734475579
    ]
    }
    },
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":"September",
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.219762802124023,
        60.441894046063425
    ]
    }
    },

    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":"September",
    "days":"",
    "organiser":"desc of events",
    "eventType":"0",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.218732833862305,
          60.43791376794984
    ]
    }
    },
    {
        "type": "Feature",
        "properties": { "Name":"SensorDevice06",
        "year":"1890",
        "time":"September",
        "days":"",
        "organiser":"desc of events",
        "eventType":"10",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.212553024291992,
            60.436473972823286
        ]
        }
        },
    
        {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":"September",
        "days":"",
        "organiser":"desc of events",
        "eventType":"10",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.214698791503903,
          60.43537290998097
        ]
        }
        },
        {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":"September",
        "days":"",
        "organiser":"desc of events",
        "eventType":"10",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.215900421142578,
            60.43338243248793
        ]
        }
        },
    
        {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":"September",
        "days":"",
        "organiser":"desc of events",
        "eventType":"10",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.216758728027344,
          60.441258927991655
        ]
        }
        },
    
        {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":"September",
        "days":"",
        "organiser":"desc of events",
        "eventType":"10",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.21014976501465,
            60.434017704505926
        ]
        }
        },
    
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":"September",
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.200794219970703,
          60.42973996658771
    ]
    }
    },
    {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":"September",
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
    22.21748828887939,
          60.434547088369825
    ]
    }
    },
    {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":"September",
        "days":"",
        "organiser":"desc of events",
        "eventType":"10",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.21886157989502,
            60.434187108280454
        ]
        }
        },
        {
            "type": "Feature",
            "properties": { "Name":"SensorDevice17",
            "year":"1890",
            "time":"September",
            "days":"",
            "organiser":"desc of events",
            "eventType":"10",
            "notes":"desc of events"},
            "geometry": {
            "type": "Point",
            "coordinates": [
                22.218518257141113,
                60.434949414339926
            ]
            }
            },
            {
                "type": "Feature",
                "properties": { "Name":"SensorDevice17",
                "year":"1890",
                "time":"September",
                "days":"",
                "organiser":"desc of events",
                "eventType":"10",
                "notes":"desc of events"},
                "geometry": {
                "type": "Point",
                "coordinates": [
                    22.222251892089844,
                    60.433191848461384
                ]
                }
                },
                {
                    "type": "Feature",
                    "properties": { "Name":"SensorDevice17",
                    "year":"1890",
                    "time":"September",
                    "days":"",
                    "organiser":"desc of events",
                    "eventType":"10",
                    "notes":"desc of events"},
                    "geometry": {
                    "type": "Point",
                    "coordinates": [
                        22.218518257141113,
                        60.434949414339926
                    ]
                    }
                    },
                    {
                        "type": "Feature",
                        "properties": { "Name":"SensorDevice17",
                        "year":"1890",
                        "time":"September",
                        "days":"",
                        "organiser":"desc of events",
                        "eventType":"10",
                        "notes":"desc of events"},
                        "geometry": {
                        "type": "Point",
                        "coordinates": [
                            22.222251892089844,
                            60.433191848461384
                        ]
                        }
                        },
                        {
                            "type": "Feature",
                            "properties": { "Name":"SensorDevice17",
                            "year":"1890",
                            "time":"September",
                            "days":"",
                            "organiser":"desc of events",
                            "eventType":"10",
                            "notes":"desc of events"},
                            "geometry": {
                            "type": "Point",
                            "coordinates": [
                                22.21886157989502,
                                60.436029317319516
                            ]
                            }
                            },
                            {
                                "type": "Feature",
                                "properties": { "Name":"SensorDevice17",
                                "year":"1890",
                                "time":"September",
                                "days":"",
                                "organiser":"desc of events",
                                "eventType":"10",
                                "notes":"desc of events"},
                                "geometry": {
                                "type": "Point",
                                "coordinates": [
                                    22.21911907196045,
                                    60.43962873478501
                                ]
                                }
                                },
                                              
                                {
    "type": "Feature",
    "properties": { "Name":"SensorDevice17",
    "year":"1890",
    "time":"September",
    "days":"",
    "organiser":"desc of events",
    "eventType":"10",
    "notes":"desc of events"},
    "geometry": {
    "type": "Point",
    "coordinates": [
        22.211651802062985,
        60.43632575499799
    ]
    }
    },
    {
        "type": "Feature",
        "properties": { "Name":"SensorDevice17",
        "year":"1890",
        "time":"September",
        "days":"",
        "organiser":"desc of events",
        "eventType":"10",
        "notes":"desc of events"},
        "geometry": {
        "type": "Point",
        "coordinates": [
            22.219505310058594,
            60.436770406446065
        ]
        }
        },
        {
            "type": "Feature",
            "properties": { "Name":"SensorDevice17",
            "year":"1890",
            "time":"September",
            "days":"",
            "organiser":"desc of events",
            "eventType":"10",
            "notes":"desc of events"},
            "geometry": {
            "type": "Point",
            "coordinates": [
                22.212638854980465,
          60.438273706764974
            ]
            }
            },
            {
                "type": "Feature",
                "properties": { "Name":"SensorDevice17",
                "year":"1890",
                "time":"September",
                "days":"",
                "organiser":"desc of events",
                "eventType":"10",
                "notes":"desc of events"},
                "geometry": {
                "type": "Point",
                "coordinates": [
                    22.213754653930664,
                    60.439776937546895
                ]
                }
                },
                {
                    "type": "Feature",
                    "properties": { "Name":"SensorDevice17",
                    "year":"1890",
                    "time":"September",
                    "days":"",
                    "organiser":"desc of events",
                    "eventType":"10",
                    "notes":"desc of events"},
                    "geometry": {
                    "type": "Point",
                    "coordinates": [
                        22.2137975692749,
                        60.437786729769165
                    ]
                    }
                    },
                    {
                        "type": "Feature",
                        "properties": { "Name":"SensorDevice17",
                        "year":"1890",
                        "time":"September",
                        "days":"",
                        "organiser":"desc of events",
                        "eventType":"10",
                        "notes":"desc of events"},
                        "geometry": {
                        "type": "Point",
                        "coordinates": [
                            22.215213775634766,
                            60.436664537605466
                        ]
                        }
                        },
                        {
                            "type": "Feature",
                            "properties": { "Name":"SensorDevice17",
                            "year":"1890",
                            "time":"September",
                            "days":"",
                            "organiser":"desc of events",
                            "eventType":"10",
                            "notes":"desc of events"},
                            "geometry": {
                            "type": "Point",
                            "coordinates": [
                                22.20963478088379,
                                60.43552113215167
                            ]
                            }
                            },
                            {
                                "type": "Feature",
                                "properties": { "Name":"SensorDevice17",
                                "year":"1890",
                                "time":"September",
                                "days":"",
                                "organiser":"desc of events",
                                "eventType":"10",
                                "notes":"desc of events"},
                                "geometry": {
                                "type": "Point",
                                "coordinates": [
                                    22.213926315307617,
          60.43907826146615
                                ]
                                }
                                },
                                              
      
              {
              "type": "Feature",
              "geometry": {
                  "type": "Point",
                  "coordinates":  [22.19701766967773,
                        60.42889282299763]
              },
              "properties": {
              "Name":"SensorDevice08",
              "year":"1893",
              "time":"September",
              "days":"21",
              "eventType":"10",
              "notes":"desc of events"
              }
              }
              ]};
      

        var addressPoints = [
            [60.4313, 22.2143, "2"],
            [60.4301, 22.2119, "3"],
            [60.4403, 22.2205, "6"],
            [60.4379, 22.2187, "4"],
            [60.4385, 22.2219, "10"]

        ]


        var map = new L.map("map", {
      
                        center: [60.4336, 22.1930],//22.2177, 60.438  60.4216, 22.1982
                        zoom: 14.49
                    //center: [60.4349, 22.1892],
                    //zoom: 14.19
                      });

        //map.invalidateSize(true);
        

        var mbAttr = 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, ' +
        'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
        mbUrl = 'https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw';

        L.tileLayer(mbUrl, {id: 'mapbox/light-v9', tileSize: 512, zoomOffset: -1, attribution: mbAttr}).addTo(map)
      
        //var pulsingIcon = L.icon.pulse({iconSize:[18,18],color:'#d5759a'});
        //var ao = L.marker([60.42097096224303, 22.17041015625],{icon: pulsingIcon}).addTo(map); 
      
        //L.geoJSON(jsontest).addTo(map);    
          
        var healthy = {
                            radius: 8,
                            fillColor: "#08979D",
                            weight: 0,
                            opacity: 0,
                            fillOpacity: 0.76
                        };

        var ol = {
                            radius: 12,
                            fillColor: "#A29E93",
                            weight: 0,
                            opacity: 0,
                            fillOpacity: 0.7
                        };

      
        var risks = {
                            radius: 15,
                            fillColor: "#6060C4", //#FF5100
                            weight: 0,
                            opacity: 0,
                            fillOpacity: 0.8
                        };
      
        var attackedOnes = {
                            radius: 17,
                            fillColor: "#c95d4e",
                            weight: 0,
                            opacity: 0,
                            fillOpacity: 0.9

  
                        };

  //high risk vis;   
        var atest = [
          [60.4344, 22.1952],
          [60.4214, 22.1785],
          [60.4365, 22.2052],
          [60.4256, 22.1528],
          [60.4331, 22.2248],
          [60.4233, 22.1907]
          ]
      


      for (var i = 0; i < atest.length; i++) {
          var id = i;
          var cx= "marker" + id;
          var pictures = L.marker(atest[i], {
                      icon: L.divIcon({
                          className: 'leaflet-echart-icon',
                          iconSize: [30, 30],
                          html: '<div id="' + cx + '"style="width: 60px; height: 60px; position: relative; background-color: transparent;"></div>'
                      })
                  }).addTo(map);
                  
          var myChart = echarts.init(document.getElementById(cx));

          var colorPalette = ['#C8AEAC']
                
          option = {
                    
                      tooltip: {
                          trigger: 'item',
                          //设置背景图片 rgba格式
                        color: "black",
                        borderWidth: "1", //边框宽度设置1
                        borderColor: "ffffff", //设置边框颜色
                        textStyle: {
                          color: "#666666" //设置文字颜色
                        },
                        formatter: '{b0}',

                      },
                      
                      series: [
                          {
                              color: colorPalette,
                              name: 'Security issues',
                              type: 'pie',
                              selectedMode: 'single',
                              radius: [0, '24%'],
                              
                              labelLine: {
                                  show: false
                              },
                              data: [
                                
                                  
                                  {value: "2", name: 'Security issues'}
                              ]
                          },
                          {
                            color: '#A57891',
                              name: '',
                              type: 'pie',
                              radius: ['26%', '78%'],
                              labelLine: {
                                  length: 30,
                              },
                              label: {
                                show: false
                              },
                              data: [
                                  {value: 600, name: 'High risky'}
                                
                            
                              ]
                          }
                      ]
                  };

          myChart.setOption(option);

          }



 //Low risk vis;   

 var atestk = [
          [60.4286, 22.1990],
          [60.4410, 22.2144],
          [60.4226, 22.2052],
          [60.4256, 22.1687]
          ]
      


          for (var j = 0; j < atestk.length; j++) {
          var idl = j;
          var cxl= "marker" + idl;
          var picturel = L.marker(atestk[j], {
                      icon: L.divIcon({
                          className: 'leaflet-echart-icon',
                          iconSize: [30, 30],
                          html: '<div id="' + cxl + '"style="width: 50px; height: 60px; position: relative; background-color: transparent;"></div>'
                      })
                  }).addTo(map);
                  
          var myChart = echarts.init(document.getElementById(cxl));

          var colorPalette = ['#C8AEAC']
                
          option = {
                    
                      tooltip: {
                          trigger: 'item',
                          //设置背景图片 rgba格式
                        color: "black",
                        borderWidth: "1", //边框宽度设置1
                        borderColor: "ffffff", //设置边框颜色
                        textStyle: {
                          color: "#666666" //设置文字颜色
                        },
                        formatter: '{b0}',

                      },
                      
                      series: [
                          {
                              color: colorPalette,
                            
                              name: 'Security issues',
                              type: 'pie',
                              selectedMode: 'single',
                              radius: [0, '24%'],
                              
                              labelLine: {
                                  show: false
                              },
                              data: [
                                
                                  
                                  {value: "2", name: 'Security issues'}
                              ]
                          },
                          {
                            color: '#EECA66',
                              name: '',
                              type: 'pie',
                              radius: ['26%', '62%'],
                              labelLine: {
                                  length: 30,
                              },
                              label: {
                                show: false
                              },
                              data: [
                                  {value: 600, name: 'Low risky'}
                                
                            
                              ]
                          }
                      ]
                  };

          myChart.setOption(option);

          }









        //var pulsingIcon = L.icon.pulse({iconSize:[20,20],color:'red'});
        //var ao = L.marker(latlng,{icon: pulsingIcon}).addTo(map);               
      
        L.geoJSON(jsontest, {
                            pointToLayer: function (feature, latlng) {
                              if (feature.properties.eventType == "10") {
                              return L.circleMarker(latlng, healthy);
                          } else if (feature.properties.eventType == "0")
                            {
                                return L.circleMarker(latlng, ol);
                            }
                          else if (feature.properties.eventType == "20")
                            {
                                return L.circleMarker(latlng, healthy);
                            } else if (feature.properties.eventType == "30")
                              {
                                
                                var pulsingIcon = L.icon.pulse({iconSize:[20,20],color:'#5A2E2D'});
                                var ao = L.marker(latlng,{icon: pulsingIcon});
                                return ao;
                              }
                        },
                        onEachFeature: onEachFeature
                        }).addTo(map);      
      


                  
        function onEachFeature(feature, layer) {
      
        var vary;
        var ic;
        var se;
        var template = '<form id="popup-form">\
                       <textarea id="input-speed" class="popup-input" type="text" style="height: 41px;"></textarea>\
                       <div id="vi"></div>\
                       <input class="w3-radio" type="radio" name="gender" value="male" checked>\
                       <label>Urgent</label>\
                       <input class="w3-radio" type="radio" name="gender" value="female">\
                       <label>Minor</label>\
                       <input class="w3-radio" type="radio" name="gender" value="okay">\
                       <label>Minor</label><br>\
                       <button id="button-submit" type="button" class="btn btn-primary btn-sm" style="margin-top: 6px;">Send</button>\
                       </form>';

        var popbase = '<div class="card-box">\
                    <div class="card-title" >\
                        <h2><i class="fas fa-virus" style="color:red;"></i> Malware Detection</h2>\
                        <p>SensorTest01</p>\
                        <p>Security Health: Under Attack!</p>\
                        <p>Time: 2021-9-16T12:16:37+03:00</p>\
                        <p>Prvious Issues: </p>\
                        <p style="font-size: 11px;">Anything new?</p>\
                    </div>\
                    <div class="card-link" style="margin-top: 9px;">\
                      <form id="popup-form">\
                       <textarea id="input-speed" class="popup-input" type="text" style="height: 32px; width: 270px;"></textarea>\
                       <div style="margin-bottom: 6px;" id="vi"></div>\
                       <input class="w3-radio" type="radio" name="gender" value="male">\
                       <label>Urgent</label>\
                       <input class="w3-radio" type="radio" name="gender" value="female">\
                       <label>Low risk</label>\
                       <input class="w3-radio" type="radio" name="gender" value="okay">\
                       <label>Attacked</label>\
                       <input class="w3-radio" type="radio" name="gender" value="okay">\
                       <label>Offline</label>\
                       </form>\
                        <a class="c-link" id="button-submit" type="button">Send\
                            <i class="fa fa-angle-right"></i>\
                        </a>\
                    </div>\
                </div>';

        var popbaseN = '<div class="card-box">\
                    <div class="card-title" >\
                      <h2><i class="material-icons" style="color:#469324; font-size: 19px;">security</i> SensorTest01</h2>\
                        <p>Security Health: Good</p>\
                        <p>Time: 2021-9-16T12:16:37+03:00</p>\
                        <p>Prvious Issues: None</p>\
                        <p style="font-size: 11px;">Anything new?</p>\
                    </div>\
                    <div class="card-link" style="margin-top: 9px;">\
                      <form id="popup-form">\
                       <textarea id="input-speed" class="popup-input" type="text" style="height: 32px; width: 270px;"></textarea>\
                       <div style="margin-bottom: 6px;" id="vi"></div>\
                       <input class="w3-radio" type="radio" name="gender" value="male">\
                       <label>Urgent</label>\
                       <input class="w3-radio" type="radio" name="gender" value="female">\
                       <label>Low risk</label>\
                       <input class="w3-radio" type="radio" name="gender" value="okay">\
                       <label>Attacked</label>\
                       <input class="w3-radio" type="radio" name="gender" value="okay">\
                       <label>Offline</label>\
                       </form>\
                        <a class="c-link" id="button-submit" type="button">Send\
                            <i class="fa fa-angle-right"></i>\
                        </a>\
                    </div>\
                </div>';

                

        var popbaseR = '<div class="card-box">\
                    <div class="card-title" >\
                      <h2><i class="fas fa-exclamation-triangle"></i> SensorTest01</h2>\
                        <p>Security Health: Good</p>\
                        <p>Time: 2021-9-16T12:16:37+03:00</p>\
                        <p>Prvious Issues:</p>\
                        <p style="font-size: 11px;">Anything new?</p>\
                    </div>\
                    <div class="card-link" style="margin-top: 9px;">\
                      <form id="popup-form">\
                       <textarea id="input-speed" class="popup-input" type="text" style="height: 32px; width: 270px;"></textarea>\
                       <div style="margin-bottom: 6px;" id="vi"></div>\
                       <input class="w3-radio" type="radio" name="gender" value="male">\
                       <label>Urgent</label>\
                       <input class="w3-radio" type="radio" name="gender" value="female">\
                       <label>Low risk</label>\
                       <input class="w3-radio" type="radio" name="gender" value="okay">\
                       <label>Attacked</label>\
                       <input class="w3-radio" type="radio" name="gender" value="okay">\
                       <label>Offline</label>\
                       </form>\
                        <a class="c-link" id="button-submit" type="button">Send\
                            <i class="fa fa-angle-right"></i>\
                        </a>\
                    </div>\
                </div>';

                var popbase0 = '<div class="card-box">\
                    <div class="card-title" >\
                      <h2><i class="material-icons">portable_wifi_off</i> SensorTest07</h2>\
                        <p>Security Health: Offline</p>\
                        <p>Time: 2021-9-16T12:16:37+03:00</p>\
                        <p>Prvious Issues: None</p>\
                        <p style="font-size: 11px;">Anything new?</p>\
                    </div>\
                    <div class="card-link" style="margin-top: 9px;">\
                      <form id="popup-form">\
                       <textarea id="input-speed" class="popup-input" type="text" style="height: 32px; width: 270px;"></textarea>\
                       <div style="margin-bottom: 6px;" id=""></div>\
                       <input class="w3-radio" type="radio" name="gender" value="male">\
                       <label>Urgent</label>\
                       <input class="w3-radio" type="radio" name="gender" value="female">\
                       <label>Low risk</label>\
                       <input class="w3-radio" type="radio" name="gender" value="okay">\
                       <label>Attacked</label>\
                       <input class="w3-radio" type="radio" name="gender" value="okay">\
                       <label>Offline</label>\
                       </form>\
                        <a class="c-link" id="button-submit" type="button">Send\
                            <i class="fa fa-angle-right"></i>\
                        </a>\
                    </div>\
                </div>';
        
          var vis = '<div class="card-box">\
                  <div class="card-link" style="margin-top: 9px;">\
                    <div id="radial-chart-primary"></div>\
                    </div>\
                </div>';
        

        var popupContentw = '<div class="card-box"><div class="card-title" >\
                      <h2><i class="fas fa-paper-plane" style="color: #FF5722;"></i> The issues has been sent ！</h2>\
                    </div>\
                </div>';



                var x =  '<div class="row"><div class="col-md-4"><div class="card-box">\
        <div class="card-title"><h2>Lorem ipsum dolor si.</h2><p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Assumenda, </p>\
        </div><div class="card-link"><a href="" class="c-link">Learn More</a>\
      </div></div></div>\
<div class="col-md-4">\
    <div class="card-box">\
        <div class="card-title">\
            <h2>Lorem ipsum dolor si.</h2>\
            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Assumenda, </p>\
        </div><div class="card-link"><a href="" class="c-link">Learn More\
                <i class="fa fa-angle-right"></i></a></div></div></div>\
<div class="col-md-4">\
    <div class="card-box">\
        <div class="card-title">\
            <h2>Lorem ipsum dolor si.</h2>\
            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Assumenda, </p>\
        </div></div></div></div>';

        var customOptions =
            {
              'maxWidth': '500',
              'className' : 'custom'
            }

                        
        switch (feature.properties.eventType) {

                          case "0":  //healthy ones
                            vary = popbase0;
                            se = "all fine";
                            ic="SEnsorname";
                            break;
                          case "10":  //healthy ones
                            vary = popbaseN;
                            se = "all fine";
                            ic="SEnsorname";
                            break;
                          case "20": //risky ones 
                            vary = popbaseR;
                            se = "risky";
                            ic="<i class='material-icons' style='color:pink'>warning</i>Malware Detection!";
                            break;
                          case "30": //under atatck ones
                            vary = popbase;
                            se = "Malware Detetcion";
                            ic="<i class='material-icons' style='color:red'>error</i> Malware Detection!";
                            break;
                        }
                    
        var popupContent = vary;

  
        
        pictures.bindPopup(popbaseN);

        layer.bindPopup(popupContent,customOptions);

        layer.on('click', layerClickHandler);
                        
        function layerClickHandler (e) {

             

              var marker = e.target;
                    properties = e.target.feature.properties;
                                
              if (marker.hasOwnProperty('_popup')) {
                                    //circleMarker.unbindPopup();
              }

              marker.bindPopup(popupContent);
              marker.openPopup();

              L.DomUtil.get('vi').textContent = properties.notes;

              var inputSpeed = L.DomUtil.get('input-speed');
              //inputSpeed.value = properties.notes;
              inputSpeed.value = " ";
              L.DomEvent.addListener(inputSpeed, 'change', function (e) {
                var temp = e.target.value;
                	      const http = new EasyHTTP;
                // User Data
                	      var data = {"id":3,"value":temp};

			      // Update Post
			      http.put(
			      'http://localhost:8088/api/clients/wks-96445-mac.ad.tuni.fi/30602/0/3',
				data)
			      .then(data => console.log(data))
			      .catch(err => console.log(err));
              });

              var buttonSubmit = L.DomUtil.get('button-submit');
              L.DomEvent.addListener(buttonSubmit, 'click', function (e) {
              e.preventDefault();
              marker.bindPopup(popupContentw);
              });

              } //click function


              var markers = L.markerClusterGroup({
              singleMarkerMode: true,
              zoomToBoundsOnClick: true,
              iconCreateFunction: function (cluster) {
                 
                  var childCount = cluster.getChildCount();
                  var c = ' marker-cluster-';
                  if (childCount < 10) {
                    c += 'medium';
                  } 
                  else if (childCount < 100) {
                    c += 'small';
                  } 
                  else {
                    c += 'large';
            }

            return new L.DivIcon({ html: '<div><span>' + childCount + '</span></div>', 
            className: 'marker-cluster' + c, iconSize: new L.Point(40, 40) });
        }
      });

          for (var i = 0; i < addressPoints.length; i++) {
            var a = addressPoints[i];
            var title = a[2];
            var marker = L.marker(new L.LatLng(a[0], a[1]), {
            
              title: title
            });
            marker.bindPopup(popupContent);
            markers.addLayer(marker);
          }

          map.addLayer(markers);

          
       

        


                        //bindTooltip bindPopup
                        //layer.bindTooltip(feature.properties.time);
         } //eachfeature function
    
   
            
      } //loadNames function

      loadNames();
     

</script>

 <script type="text/javascript">

      class EasyHTTP {

      // Make an HTTP PUT Request
      async put(url, data) {

        // Awaiting fetch which contains method,
        // headers and content-type and body
          const response = await fetch(url, {
          method: 'PUT',
          headers: {
            'Content-type': 'application/json'
          },
          body: JSON.stringify(data)
          });
          
          // Awaiting response.json()
          const resData = await response.json();

          // Return response data
          return resData;
        }
      }
    

  </script>	
	

</body>
</html>


